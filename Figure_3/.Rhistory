scale_fill_manual(values=group.colors3)+
scale_shape_manual(values=group.shape)
if (!require(data.table)) install.packages('data.table')
library(data.table)
if (!require(RColorBrewer)) install.packages('RColorBrewer')
library(RColorBrewer)
if (!require(dplyr)) install.packages('dplyr')
library(dplyr)
if (!require(ggrepel)) install.packages('ggrepel')
library(ggrepel)
##Set wd based on source
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
dir.create("output_data/")
# Data_wrangling ----------------------------------------------------------
Cas9_fertility<-read.table("input_data/Cas9_fertility.txt", header=T, sep="\t")
Cas9_fertility$replicate<-as.factor(Cas9_fertility$replicate)
group.colors3 <- c(female = "orangered", male = "dodgerblue2",WT="grey")
group.shape <- c("1" = 21, "2" = 23, "3"=22)
Cas9_fertilitym<-melt(Cas9_fertility, id.vars=c("replicate","strain","sex","cross"))
Cas9_fertilitym$replicate<-as.factor(Cas9_fertilitym$replicate)
Cas9_fertilitym$selected_variable<-"no"
Cas9_fertilitym$selected_variable[Cas9_fertilitym$variable=="embryos"]<-"yes"
Cas9_fertilitym$selected_variable[Cas9_fertilitym$variable=="pupua2embryos"]<-"yes"
Cas9_fertilitym$selected_variable[Cas9_fertilitym$variable=="adult2embryo"]<-"yes"
View(Cas9_fertility)
if (!require(ggplot2)) install.packages('ggplot2')
library(ggplot2)
if (!require(data.table)) install.packages('data.table')
library(data.table)
if (!require(RColorBrewer)) install.packages('RColorBrewer')
library(RColorBrewer)
if (!require(dplyr)) install.packages('dplyr')
library(dplyr)
if (!require(ggrepel)) install.packages('ggrepel')
library(ggrepel)
##Set wd based on source
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
dir.create("output_data/")
# Data_wrangling ----------------------------------------------------------
Cas9_srd<-read.table("input_data/Cas9_srd.txt", header=T, sep="\t")
group.colors3 <- c(F = "orangered", M = "dodgerblue2",None="grey")
Cas9_srd$cross <- factor(Cas9_srd$cross,levels = c("Cas9.1", "Cas9.2","double","Cas12a.multiplex", "WT"))
levels(Cas9_srd$cross)
ggplot()+
geom_hline(yintercept=50)+
geom_boxplot(data=Cas9_srd, aes(x=strain, y=pct_male, fill=Transgenic_Parent),alpha=0.7, position = position_dodge2(preserve = "single"))+
geom_point(data=Cas9_srd, aes(x=strain, y=pct_male,fill=Transgenic_Parent),alpha=0.7,shape=21,color="black",size=3,position = position_dodge(width = 0.8))+
facet_grid(~cross, scales = "free_x",space = "free")+
theme_bw(base_size=15)+
xlab("")+ylab("")+
theme(legend.position = "none")+
scale_fill_manual(values=group.colors3)+
ylim(35,90)
Cas9_srd$cross <- factor(Cas9_srd$cross,levels = c("Cas12a.multiplex","Cas9.1", "Cas9.2","double", "WT"))
ggplot()+
geom_hline(yintercept=50)+
geom_boxplot(data=Cas9_srd, aes(x=strain, y=pct_male, fill=Transgenic_Parent),alpha=0.7, position = position_dodge2(preserve = "single"))+
geom_point(data=Cas9_srd, aes(x=strain, y=pct_male,fill=Transgenic_Parent),alpha=0.7,shape=21,color="black",size=3,position = position_dodge(width = 0.8))+
facet_grid(~cross, scales = "free_x",space = "free")+
theme_bw(base_size=15)+
xlab("")+ylab("")+
theme(legend.position = "none")+
scale_fill_manual(values=group.colors3)+
ylim(35,90)
ggplot()+
geom_hline(yintercept=50)+
geom_boxplot(data=Cas9_srd, aes(x=strain, y=pct_male, fill=Transgenic_Parent),alpha=0.7, position = position_dodge2(preserve = "single"))+
geom_point(data=Cas9_srd, aes(x=strain, y=pct_male,fill=Transgenic_Parent),alpha=0.7,shape=21,color="black",size=3,position = position_dodge(width = 0.8))+
#facet_grid(~cross, scales = "free_x",space = "free")+
theme_bw(base_size=15)+
xlab("")+ylab("")+
theme(legend.position = "none")+
scale_fill_manual(values=group.colors3)+
ylim(35,90)
ggsave("output_data/SRD2.png",width=10, height=3)
levels(Cas9_srd$strain)
Cas9_srd$strain <- factor(Cas9_srd$strain,levels = c("1","1a","1b","1c","1d","1e","1f","1g","2a","2b","2c","2d","1e+2a","1e+2c","2a+2c","WT"))
ggplot()+
geom_hline(yintercept=50)+
geom_boxplot(data=Cas9_srd, aes(x=strain, y=pct_male, fill=Transgenic_Parent),alpha=0.7, position = position_dodge2(preserve = "single"))+
geom_point(data=Cas9_srd, aes(x=strain, y=pct_male,fill=Transgenic_Parent),alpha=0.7,shape=21,color="black",size=3,position = position_dodge(width = 0.8))+
#facet_grid(~cross, scales = "free_x",space = "free")+
theme_bw(base_size=15)+
xlab("")+ylab("")+
theme(legend.position = "none")+
scale_fill_manual(values=group.colors3)+
ylim(35,90)
ggsave("output_data/SRD2.png",width=10, height=3)
ggplot()+
geom_hline(yintercept=50)+
geom_boxplot(data=Cas9_srd, aes(x=strain, y=pct_male, fill=Transgenic_Parent),alpha=0.7, position = position_dodge2(preserve = "single"))+
geom_point(data=Cas9_srd, aes(x=strain, y=pct_male,fill=Transgenic_Parent),alpha=0.7,shape=21,color="black",size=3,position = position_dodge(width = 0.8))+
#facet_grid(~cross, scales = "free_x",space = "free")+
theme_bw(base_size=15)+
xlab("")+ylab("")+
theme(legend.position = "none")+
scale_fill_manual(values=group.colors3)+
ylim(35,90)
Cas9_srd1<-subset(Cas9_srd, Cas9_srd$cross=c("1e+2a","1e+2c","2a+2c","WT"))
Cas9_srd1<-subset(Cas9_srd, Cas9_srd$cross=c("1e+2a","1e+2c","2a+2c","WT"))
Cas9_srd1<-subset(Cas9_srd, Cas9_srd$cross==c("1e+2a","1e+2c","2a+2c","WT"))
Cas9_srd1<-subset(Cas9_srd, Cas9_srd$strain==c("1e+2a","1e+2c","2a+2c","WT"))
Cas9_srd1<-subset(Cas9_srd, Cas9_srd$strain=c("1e+2a","1e+2c","2a+2c","WT"))
Cas9_srd$sel<-1
Cas9_srd$sel[Cas9_srd$cross == "double"]<-2
Cas9_srd$sel[Cas9_srd$cross == "WT"]<-2
Cas9_srd<-read.table("input_data/Cas9_srd.txt", header=T, sep="\t")
group.colors3 <- c(F = "orangered", M = "dodgerblue2",None="grey")
Cas9_srd$cross <- factor(Cas9_srd$cross,levels = c("Cas12a.multiplex","Cas9.1", "Cas9.2","double", "WT"))
Cas9_srd$strain <- factor(Cas9_srd$strain,levels = c("1","1a","1b","1c","1d","1e","1f","1g","2a","2b","2c","2d","1e+2a","1e+2c","2a+2c","WT"))
levels(Cas9_srd$strain)
Cas9_srd$sel<-1
Cas9_srd$sel[Cas9_srd$cross == "double"]<-2
Cas9_srd$sel[Cas9_srd$cross == "WT"]<-2
Cas9_srd<-read.table("input_data/Cas9_srd.txt", header=T, sep="\t")
group.colors3 <- c(F = "orangered", M = "dodgerblue2",None="grey")
Cas9_srd$cross <- factor(Cas9_srd$cross,levels = c("Cas12a.multiplex","Cas9.1", "Cas9.2","double", "WT"))
Cas9_srd$strain <- factor(Cas9_srd$strain,levels = c("1","1a","1b","1c","1d","1e","1f","1g","2a","2b","2c","2d","1e+2a","1e+2c","2a+2c","WT"))
levels(Cas9_srd$strain)
Cas9_srd$sel<-1
Cas9_srd$sel[Cas9_srd$cross == "double"]<-2
Cas9_srd$sel[Cas9_srd$cross == "WT"]<-2
View(Cas9_srd)
Cas9_srd1<-subset(Cas9_srd, Cas9_srd$sel==1)
Cas9_srd2<-subset(Cas9_srd, Cas9_srd$sel==2)
ggplot()+
geom_hline(yintercept=50)+
geom_boxplot(data=Cas9_srd1, aes(x=strain, y=pct_male, fill=Transgenic_Parent),alpha=0.7, position = position_dodge2(preserve = "single"))+
geom_point(data=Cas9_srd1, aes(x=strain, y=pct_male,fill=Transgenic_Parent),alpha=0.7,shape=21,color="black",size=3,position = position_dodge(width = 0.8))+
#facet_grid(~cross, scales = "free_x",space = "free")+
theme_bw(base_size=15)+
xlab("")+ylab("")+
theme(legend.position = "none")+
scale_fill_manual(values=group.colors3)+
ylim(35,90)
ggsave("output_data/SRD3.png",width=10, height=3)
ggplot()+
geom_hline(yintercept=50)+
geom_boxplot(data=Cas9_srd2, aes(x=strain, y=pct_male, fill=Transgenic_Parent),alpha=0.7, position = position_dodge2(preserve = "single"))+
geom_point(data=Cas9_srd2, aes(x=strain, y=pct_male,fill=Transgenic_Parent),alpha=0.7,shape=21,color="black",size=3,position = position_dodge(width = 0.8))+
#facet_grid(~cross, scales = "free_x",space = "free")+
theme_bw(base_size=15)+
xlab("")+ylab("")+
theme(legend.position = "none")+
scale_fill_manual(values=group.colors3)+
ylim(35,90)
ggsave("output_data/SRD4.png",width=10, height=3)
ggplot()+
geom_hline(yintercept=50)+
geom_boxplot(data=Cas9_srd1, aes(x=strain, y=pct_male, fill=Transgenic_Parent),alpha=0.7, position = position_dodge2(preserve = "single"))+
geom_point(data=Cas9_srd1, aes(x=strain, y=pct_male,fill=Transgenic_Parent),alpha=0.7,shape=21,color="black",size=3,position = position_dodge(width = 0.8))+
#facet_grid(~cross, scales = "free_x",space = "free")+
theme_bw(base_size=15)+
xlab("")+ylab("")+
theme(legend.position = "none")+
scale_fill_manual(values=group.colors3)+
ylim(35,90)
ggsave("output_data/SRD3.png",width=5, height=3)
ggplot()+
geom_hline(yintercept=50)+
geom_boxplot(data=Cas9_srd2, aes(x=strain, y=pct_male, fill=Transgenic_Parent),alpha=0.7, position = position_dodge2(preserve = "single"))+
geom_point(data=Cas9_srd2, aes(x=strain, y=pct_male,fill=Transgenic_Parent),alpha=0.7,shape=21,color="black",size=3,position = position_dodge(width = 0.8))+
#facet_grid(~cross, scales = "free_x",space = "free")+
theme_bw(base_size=15)+
xlab("")+ylab("")+
theme(legend.position = "none")+
scale_fill_manual(values=group.colors3)+
ylim(35,90)
ggsave("output_data/SRD4.png",width=2, height=3)
ggsave("output_data/SRD3.png",width=6, height=3)
ggplot()+
geom_hline(yintercept=50)+
geom_boxplot(data=Cas9_srd1, aes(x=strain, y=pct_male, fill=Transgenic_Parent),alpha=0.7, position = position_dodge2(preserve = "single"))+
geom_point(data=Cas9_srd1, aes(x=strain, y=pct_male,fill=Transgenic_Parent),alpha=0.7,shape=21,color="black",size=3,position = position_dodge(width = 0.8))+
#facet_grid(~cross, scales = "free_x",space = "free")+
theme_bw(base_size=15)+
xlab("")+ylab("")+
theme(legend.position = "none")+
scale_fill_manual(values=group.colors3)+
ylim(35,90)
ggsave("output_data/SRD3.png",width=6, height=3)
ggsave("output_data/SRD3.png",width=8, height=3)
ggplot()+
geom_hline(yintercept=50)+
geom_boxplot(data=Cas9_srd2, aes(x=strain, y=pct_male, fill=Transgenic_Parent),alpha=0.7, position = position_dodge2(preserve = "single"))+
geom_point(data=Cas9_srd2, aes(x=strain, y=pct_male,fill=Transgenic_Parent),alpha=0.7,shape=21,color="black",size=3,position = position_dodge(width = 0.8))+
#facet_grid(~cross, scales = "free_x",space = "free")+
theme_bw(base_size=15)+
xlab("")+ylab("")+
theme(legend.position = "none")+
scale_fill_manual(values=group.colors3)+
ylim(35,90)
ggsave("output_data/SRD4.png",width=3, height=3)
ggsave("output_data/SRD4.png",width=2.5, height=3)
if (!require(ggplot2)) install.packages('ggplot2')
library(ggplot2)
if (!require(data.table)) install.packages('data.table')
library(data.table)
if (!require(RColorBrewer)) install.packages('RColorBrewer')
library(RColorBrewer)
if (!require(dplyr)) install.packages('dplyr')
library(dplyr)
if (!require(ggrepel)) install.packages('ggrepel')
library(ggrepel)
##Set wd based on source
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
dir.create("output_data/")
#----- data -------
fer<-read.table("input_data/Cas9_fertility_Niki.txt", header=T, sep="\t")
fer <- fer[,0:7]
fer$replicate <- as.factor(fer$replicate)
fer <- within(fer, strain <- relevel(strain, ref = 12))
fer <- within(fer, sex <- relevel(sex, ref = 3))
#fer <- subset(fer, cross != "WT")
fer <- subset(fer, sex != "female")
fer <- aggregate(.~strain+cross+sex, data=fer, median)
fer$replicate <- NULL
fer$survival <- fer$adults/fer$embryos
fer$crsex <- with(fer, interaction(cross, sex))
fer <- droplevels(fer)
#fer$crsex = factor(fer$crsex,levels(fer$crsex)[c(1,3,2,4)])
#fer$crsex = factor(fer$crsex,levels(fer$crsex)[c(1,2,4,3,5)])
#----- glm
out <- glm(cbind(as.integer(adults),(as.integer(embryos)-as.integer(adults))) ~ crsex, family=binomial, data=fer)
print(summary(outs))
#----- data -------
fer<-read.table("input_data/Cas9_fertility_Niki.txt", header=T, sep="\t")
fer <- fer[,0:7]
fer$replicate <- as.factor(fer$replicate)
fer <- within(fer, strain <- relevel(strain, ref = 12))
fer <- within(fer, sex <- relevel(sex, ref = 3))
#fer <- subset(fer, cross != "WT")
fer <- subset(fer, sex != "female")
fer <- aggregate(.~strain+cross+sex, data=fer, median)
fer$replicate <- NULL
fer$survival <- fer$adults/fer$embryos
fer$crsex <- with(fer, interaction(cross, sex))
fer <- droplevels(fer)
p <- ggplot(data = fer, mapping = aes(x = crsex, y = survival)) + geom_boxplot() + geom_point(size=4) + ylim(0.1,0.4)
print(p)
ggplot(data = fer, mapping = aes(x = crsex, y = survival))+
geom_boxplot()+
geom_point(aes(color=strai),size=4)+
ylim(0.1,0.4)
ggplot(data = fer, mapping = aes(x = crsex, y = survival))+
geom_boxplot()+
geom_point(aes(color=strain),size=4)+
ylim(0.1,0.4)
View(fer)
ggplot(data = fer, mapping = aes(x = crsex, y = survival))+
geom_boxplot(aes(fill=cross))+
geom_point(aes(color=strain),size=4)+
ylim(0.1,0.4)
group.colors3 <- c(Cas9.1 = "dodgerblue2", Cas9.2 = "dodgerblue2",WT="grey")
ggplot(data = fer, mapping = aes(x = crsex, y = survival))+
geom_boxplot(aes(fill=cross))+
geom_point(aes(color=strain),size=4)+
scale_fill_manual(values=group.colors3)+
ylim(0.1,0.4)
ggplot(data = fer, mapping = aes(x = crsex, y = survival))+
geom_boxplot(aes(fill=cross))+
geom_point(aes(color=strain),size=4)+
geom_text(aes(label=strain),size=4)+
scale_fill_manual(values=group.colors3)+
ylim(0.1,0.4)
ggplot(data = fer, mapping = aes(x = crsex, y = survival))+
geom_boxplot(aes(fill=cross))+
geom_point(aes(color=strain),size=4)+
geom_text(aes(label=strain,y=survival+2),size=4)+
scale_fill_manual(values=group.colors3)+
ylim(0.1,0.4)
ggplot(data = fer, mapping = aes(x = crsex, y = survival))+
geom_boxplot(aes(fill=cross))+
geom_point(aes(color=strain),size=4)+
geom_text(aes(label=strain,y=survival+0.2),size=4)+
scale_fill_manual(values=group.colors3)+
ylim(0.1,0.4)
ggplot(data = fer, mapping = aes(x = crsex, y = survival))+
geom_boxplot(aes(fill=cross))+
geom_point(aes(color=strain),size=4)+
geom_text(aes(label=strain,x=survival+0.2),size=4)+
scale_fill_manual(values=group.colors3)+
ylim(0.1,0.4)
ggplot(data = fer, mapping = aes(x = crsex, y = survival))+
geom_boxplot(aes(fill=cross))+
geom_point(aes(color=strain),size=4)+
geom_text(aes(label=strain,x=survival),size=4)+
scale_fill_manual(values=group.colors3)+
ylim(0.1,0.4)
ggplot(data = fer, mapping = aes(x = crsex, y = survival))+
geom_boxplot(aes(fill=cross))+
geom_point(aes(color=strain),size=4)+
geom_text(aes(label=strain),size=4)+
scale_fill_manual(values=group.colors3)+
ylim(0.1,0.4)
ggplot(data = fer, mapping = aes(x = crsex, y = survival))+
geom_boxplot(aes(fill=cross))+
geom_point(aes(color=strain),size=4)+
geom_text(aes(label=strain),size=6)+
scale_fill_manual(values=group.colors3)+
ylim(0.1,0.4)
ggplot(data = fer, mapping = aes(x = crsex, y = survival))+
geom_boxplot(aes(fill=cross))+
geom_point(aes(color=strain),size=4)+
scale_fill_manual(values=group.colors3)+
scale_color_brewer(palette="Spectral")()+
ylim(0.1,0.4)
ggplot(data = fer, mapping = aes(x = crsex, y = survival))+
geom_boxplot(aes(fill=cross))+
geom_point(aes(color=strain),size=4)+
scale_fill_manual(values=group.colors3)+
scale_color_brewer(palette="Spectral")+
ylim(0.1,0.4)
ggplot(data = fer, mapping = aes(x = crsex, y = survival))+
geom_boxplot(aes(fill=cross))+
geom_point(aes(color=strain),size=4)+
scale_fill_manual(values=group.colors3)+
scale_color_brewer(palette="Set1")+
ylim(0.1,0.4)
ggplot()+
geom_boxplot(data = fer, mapping = aes(x = crsex, y = survival,fill=cross))+
geom_point(aes(color=strain),size=4)+
scale_fill_manual(values=group.colors3)+
scale_color_brewer(palette="Set1")+
ylim(0.1,0.4)
ggplot()+
geom_boxplot(data = fer, aes(x = crsex, y = survival,fill=cross))+
geom_point(data=fer, aes(x = crsex, y = survival,color=strain),size=4)+
scale_fill_manual(values=group.colors3)+
scale_color_brewer(palette="Set1")+
ylim(0.1,0.4)
ggplot()+
geom_boxplot(data = fer, mapping = aes(x = crsex, y = survival,fill=cross))+
geom_point(data=fer, aes(color=strain),size=4)+
scale_fill_manual(values=group.colors3)+
scale_color_brewer(palette="Set1")+
ylim(0.1,0.4)
ggplot()+
geom_boxplot(data = fer, mapping = aes(x = crsex, y = survival,fill=cross))+
geom_point(data=fer, aes(color=strain),size=4)+
scale_fill_manual(values=group.colors3)+
scale_color_brewer(palette="Set1")+
ylim(0.1,0.4)
ggplot(data = fer, mapping = aes(x = crsex, y = survival))+
geom_boxplot(aes(fill=cross))+
geom_point(aes(color=strain),size=4)+
scale_fill_manual(values=group.colors3)+
ylim(0.1,0.4)
ggplot(data = fer, mapping = aes(x = crsex, y = survival))+
geom_boxplot(aes(fill=cross))+
geom_point(size=4)+
scale_fill_manual(values=group.colors3)+
ylim(0.1,0.4)
ggplot(data = fer, mapping = aes(x = crsex, y = survival))+
geom_boxplot(aes(fill=cross))+
geom_point(size=4)+
theme_bw(base_size=15)+
xlab("")+ylab("")+
theme(legend.position = "none")+
scale_fill_manual(values=group.colors3)+
ylim(0.1,0.4)
ggsave("output_data/fertility.png",width=2.5, height=3)
ggplot(data = fer, mapping = aes(x = crsex, y = survival))+
geom_boxplot(aes(fill=cross))+
geom_point(size=3)+
theme_bw(base_size=15)+
xlab("")+ylab("")+
theme(legend.position = "none")+
scale_fill_manual(values=group.colors3)+
ylim(0.1,0.4)
ggsave("output_data/fertility.png",width=2.5, height=3)
ggsave("output_data/fertility.png",width=3, height=3)
ggplot(data = fer, mapping = aes(x = crsex, y = survival,fill=cross))+
geom_boxplot()+
geom_point(alpha=0.7, shape=21, color="black", size=3)+
theme_bw(base_size=15)+
xlab("")+ylab("")+
theme(legend.position = "none")+
scale_fill_manual(values=group.colors3)+
ylim(0.1,0.4)
ggsave("output_data/fertility.png",width=3, height=3)
ggsave("output_data/fertility.png",width=2.5, height=3)
ggplot(data = fer, mapping = aes(x = crsex, y = survival,fill=cross))+
geom_boxplot()+
geom_point(alpha=0.7, shape=21, color="black", size=3)+
geom_text(aes(label=strain))+
theme_bw(base_size=15)+
xlab("")+ylab("")+
theme(legend.position = "none")+
scale_fill_manual(values=group.colors3)+
ylim(0.1,0.4)
ggplot(data = fer, mapping = aes(x = crsex, y = survival,fill=cross))+
geom_boxplot()+
geom_point(alpha=0.7, shape=21, color="black", size=3)+
geom_text(aes(label=strain,size=6))+
theme_bw(base_size=15)+
xlab("")+ylab("")+
theme(legend.position = "none")+
scale_fill_manual(values=group.colors3)+
ylim(0.1,0.4)
ggsave("output_data/fertility2.png",width=2.5, height=3)
ggplot(data = fer, mapping = aes(x = crsex, y = survival,fill=cross))+
geom_boxplot()+
geom_point(alpha=0.7, shape=21, color="black", size=3)+
geom_text(aes(label=strain,size=6))+
theme_bw(base_size=15)+
xlab("")+ylab("")+
theme(legend.position = "none")+
scale_fill_manual(values=group.colors3)+
ylim(0.1,0.4)
ggplot(data = fer, mapping = aes(x = crsex, y = survival,fill=cross))+
geom_boxplot()+
geom_point(alpha=0.7, shape=21, color="black", size=3)+
theme_bw(base_size=15)+
xlab("")+ylab("")+
theme(legend.position = "none")+
scale_fill_manual(values=group.colors3)+
ylim(0.1,0.4)
ggplot(data = fer, mapping = aes(x = crsex, y = survival,fill=cross))+
geom_boxplot(alpha=0.7)+
geom_point(alpha=0.7, shape=21, color="black", size=3)+
theme_bw(base_size=15)+
xlab("")+ylab("")+
theme(legend.position = "none")+
scale_fill_manual(values=group.colors3)+
ylim(0.1,0.4)
ggsave("output_data/fertility2.png",width=2.5, height=3)
if (!require(ggplot2)) install.packages('ggplot2')
library(ggplot2)
if (!require(data.table)) install.packages('data.table')
library(data.table)
if (!require(RColorBrewer)) install.packages('RColorBrewer')
library(RColorBrewer)
if (!require(dplyr)) install.packages('dplyr')
library(dplyr)
if (!require(ggrepel)) install.packages('ggrepel')
library(ggrepel)
##Set wd based on source
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
dir.create("output_data/")
# Data_wrangling ----------------------------------------------------------
Cas9_srd<-read.table("input_data/Cas9_srd.txt", header=T, sep="\t")
group.colors3 <- c(F = "orangered", M = "dodgerblue2",None="grey")
Cas9_srd$cross <- factor(Cas9_srd$cross,levels = c("Cas12a.multiplex","Cas9.1", "Cas9.2","double", "WT"))
Cas9_srd$strain <- factor(Cas9_srd$strain,levels = c("1","1a","1b","1c","1d","1e","1f","1g","2a","2b","2c","2d","1e+2a","1e+2c","2a+2c","WT"))
levels(Cas9_srd$strain)
Cas9_srd$sel<-1
Cas9_srd$sel[Cas9_srd$cross == "double"]<-2
Cas9_srd$sel[Cas9_srd$cross == "WT"]<-2
Cas9_srd1<-subset(Cas9_srd, Cas9_srd$sel==1)
Cas9_srd2<-subset(Cas9_srd, Cas9_srd$sel==2)
ggplot()+
geom_hline(yintercept=50)+
geom_boxplot(data=Cas9_srd1, aes(x=strain, y=pct_male, fill=Transgenic_Parent),alpha=0.7, position = position_dodge2(preserve = "single"))+
geom_point(data=Cas9_srd1, aes(x=strain, y=pct_male,fill=Transgenic_Parent),alpha=0.7,shape=21,color="black",size=3,position = position_dodge(width = 0.8))+
#facet_grid(~cross, scales = "free_x",space = "free")+
theme_bw(base_size=15)+
xlab("")+ylab("")+
theme(legend.position = "none")+
scale_fill_manual(values=group.colors3)+
ylim(35,70)
ggplot()+
geom_hline(yintercept=50)+
geom_boxplot(data=Cas9_srd1, aes(x=strain, y=pct_male, fill=Transgenic_Parent),alpha=0.7, position = position_dodge2(preserve = "single"))+
geom_point(data=Cas9_srd1, aes(x=strain, y=pct_male,fill=Transgenic_Parent),alpha=0.7,shape=21,color="black",size=3,position = position_dodge(width = 0.8))+
#facet_grid(~cross, scales = "free_x",space = "free")+
theme_bw(base_size=15)+
xlab("")+ylab("")+
theme(legend.position = "none")+
scale_fill_manual(values=group.colors3)+
ylim(35,80)
if (!require(ggplot2)) install.packages('ggplot2')
library(ggplot2)
if (!require(data.table)) install.packages('data.table')
library(data.table)
if (!require(RColorBrewer)) install.packages('RColorBrewer')
library(RColorBrewer)
if (!require(dplyr)) install.packages('dplyr')
library(dplyr)
if (!require(ggrepel)) install.packages('ggrepel')
library(ggrepel)
##Set wd based on source
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
dir.create("output_data/")
# Data_wrangling ----------------------------------------------------------
Cas9_srd<-read.table("input_data/Cas9_srd.txt", header=T, sep="\t")
group.colors3 <- c(F = "orangered", M = "dodgerblue2",None="grey")
Cas9_srd$cross <- factor(Cas9_srd$cross,levels = c("Cas12a.multiplex","Cas9.1", "Cas9.2","double", "WT"))
Cas9_srd$strain <- factor(Cas9_srd$strain,levels = c("1","1a","1b","1c","1d","1e","1f","1g","2a","2b","2c","2d","1e+2a","1e+2c","2a+2c","WT"))
levels(Cas9_srd$strain)
Cas9_srd$sel<-1
Cas9_srd$sel[Cas9_srd$cross == "double"]<-2
Cas9_srd$sel[Cas9_srd$cross == "WT"]<-2
Cas9_srd1<-subset(Cas9_srd, Cas9_srd$sel==1)
Cas9_srd2<-subset(Cas9_srd, Cas9_srd$sel==2)
# Plotting ----------------------------------------------------------------
ggplot()+
geom_hline(yintercept=50)+
geom_boxplot(data=Cas9_srd1, aes(x=strain, y=pct_male, fill=Transgenic_Parent),alpha=0.7, position = position_dodge2(preserve = "single"))+
geom_point(data=Cas9_srd1, aes(x=strain, y=pct_male,fill=Transgenic_Parent),alpha=0.7,shape=21,color="black",size=3,position = position_dodge(width = 0.8))+
#facet_grid(~cross, scales = "free_x",space = "free")+
theme_bw(base_size=15)+
xlab("")+ylab("")+
theme(legend.position = "none")+
scale_fill_manual(values=group.colors3)+
ylim(35,80)
ggsave("output_data/SRD3.png",width=8, height=3)
